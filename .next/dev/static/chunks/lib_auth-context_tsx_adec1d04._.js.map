{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/code_space/webdev/test/lib/auth-context.tsx"],"sourcesContent":["'use client'\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react'\nimport { User } from '@/lib/types'\n\ninterface AuthContextType {\n  user: User | null\n  login: (email: string, password: string, role: User['role']) => Promise<boolean>\n  logout: () => void\n  register: (userData: Partial<User> & { password: string }) => Promise<boolean>\n  isAuthenticated: boolean\n  isLoading: boolean\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\n// Mock user storage (in production, this would be handled by a backend)\nconst USERS_STORAGE_KEY = 'cloudbites_users'\nconst CURRENT_USER_KEY = 'cloudbites_current_user'\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [isLoading, setIsLoading] = useState(true)\n\n  useEffect(() => {\n    // Check for existing session on mount\n    const savedUser = localStorage.getItem(CURRENT_USER_KEY)\n    if (savedUser) {\n      try {\n        setUser(JSON.parse(savedUser))\n      } catch (error) {\n        console.error('Error parsing saved user:', error)\n        localStorage.removeItem(CURRENT_USER_KEY)\n      }\n    }\n    setIsLoading(false)\n  }, [])\n\n  const getUsers = (): User[] => {\n    const users = localStorage.getItem(USERS_STORAGE_KEY)\n    return users ? JSON.parse(users) : []\n  }\n\n  const saveUsers = (users: User[]) => {\n    localStorage.setItem(USERS_STORAGE_KEY, JSON.stringify(users))\n  }\n\n  const login = async (email: string, password: string, role: User['role']): Promise<boolean> => {\n    setIsLoading(true)\n\n    // Simulate API call delay\n    await new Promise(resolve => setTimeout(resolve, 1000))\n\n    const users = getUsers()\n    const foundUser = users.find(u => u.email === email && u.role === role)\n\n    if (foundUser) {\n      // In production, you would hash and compare passwords properly\n      // For demo purposes, we'll accept any password for existing users\n      setUser(foundUser)\n      localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(foundUser))\n      setIsLoading(false)\n      return true\n    }\n\n    setIsLoading(false)\n    return false\n  }\n\n  const logout = () => {\n    setUser(null)\n    localStorage.removeItem(CURRENT_USER_KEY)\n  }\n\n  const register = async (userData: Partial<User> & { password: string }): Promise<boolean> => {\n    setIsLoading(true)\n\n    // Simulate API call delay\n    await new Promise(resolve => setTimeout(resolve, 1000))\n\n    const users = getUsers()\n\n    // Check if user already exists\n    if (users.some(u => u.email === userData.email)) {\n      setIsLoading(false)\n      return false\n    }\n\n    // Create new user\n    const newUser: User = {\n      id: Date.now().toString(),\n      email: userData.email!,\n      name: userData.name!,\n      phone: userData.phone || '',\n      role: userData.role!,\n      avatar: userData.avatar || `https://ui-avatars.com/api/?name=${encodeURIComponent(userData.name!)}&background=random`,\n      createdAt: new Date().toISOString(),\n      // Add role-specific fields\n      ...(userData.role === 'kitchen' && {\n        kitchenName: userData.kitchenName || '',\n        kitchenAddress: userData.kitchenAddress || '',\n        fssaiLicense: userData.fssaiLicense || '',\n        gstNumber: userData.gstNumber || '',\n        cuisine: userData.cuisine || []\n      }),\n      ...(userData.role === 'delivery' && {\n        vehicleType: userData.vehicleType || 'motorcycle',\n        licenseNumber: userData.licenseNumber || '',\n        aadharNumber: userData.aadharNumber || ''\n      })\n    }\n\n    users.push(newUser)\n    saveUsers(users)\n\n    // Auto-login after registration\n    setUser(newUser)\n    localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(newUser))\n\n    setIsLoading(false)\n    return true\n  }\n\n  const value: AuthContextType = {\n    user,\n    login,\n    logout,\n    register,\n    isAuthenticated: !!user,\n    isLoading\n  }\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAcA,MAAM,4BAAc,IAAA,6SAAa,EAA8B;AAE/D,wEAAwE;AACxE,MAAM,oBAAoB;AAC1B,MAAM,mBAAmB;AAElB,SAAS,aAAa,EAAE,QAAQ,EAA2B;;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wSAAQ,EAAc;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,wSAAQ,EAAC;IAE3C,IAAA,ySAAS;kCAAC;YACR,sCAAsC;YACtC,MAAM,YAAY,aAAa,OAAO,CAAC;YACvC,IAAI,WAAW;gBACb,IAAI;oBACF,QAAQ,KAAK,KAAK,CAAC;gBACrB,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,6BAA6B;oBAC3C,aAAa,UAAU,CAAC;gBAC1B;YACF;YACA,aAAa;QACf;iCAAG,EAAE;IAEL,MAAM,WAAW;QACf,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,OAAO,QAAQ,KAAK,KAAK,CAAC,SAAS,EAAE;IACvC;IAEA,MAAM,YAAY,CAAC;QACjB,aAAa,OAAO,CAAC,mBAAmB,KAAK,SAAS,CAAC;IACzD;IAEA,MAAM,QAAQ,OAAO,OAAe,UAAkB;QACpD,aAAa;QAEb,0BAA0B;QAC1B,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;QAEjD,MAAM,QAAQ;QACd,MAAM,YAAY,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,SAAS,EAAE,IAAI,KAAK;QAElE,IAAI,WAAW;YACb,+DAA+D;YAC/D,kEAAkE;YAClE,QAAQ;YACR,aAAa,OAAO,CAAC,kBAAkB,KAAK,SAAS,CAAC;YACtD,aAAa;YACb,OAAO;QACT;QAEA,aAAa;QACb,OAAO;IACT;IAEA,MAAM,SAAS;QACb,QAAQ;QACR,aAAa,UAAU,CAAC;IAC1B;IAEA,MAAM,WAAW,OAAO;QACtB,aAAa;QAEb,0BAA0B;QAC1B,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;QAEjD,MAAM,QAAQ;QAEd,+BAA+B;QAC/B,IAAI,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,SAAS,KAAK,GAAG;YAC/C,aAAa;YACb,OAAO;QACT;QAEA,kBAAkB;QAClB,MAAM,UAAgB;YACpB,IAAI,KAAK,GAAG,GAAG,QAAQ;YACvB,OAAO,SAAS,KAAK;YACrB,MAAM,SAAS,IAAI;YACnB,OAAO,SAAS,KAAK,IAAI;YACzB,MAAM,SAAS,IAAI;YACnB,QAAQ,SAAS,MAAM,IAAI,CAAC,iCAAiC,EAAE,mBAAmB,SAAS,IAAI,EAAG,kBAAkB,CAAC;YACrH,WAAW,IAAI,OAAO,WAAW;YACjC,2BAA2B;YAC3B,GAAI,SAAS,IAAI,KAAK,aAAa;gBACjC,aAAa,SAAS,WAAW,IAAI;gBACrC,gBAAgB,SAAS,cAAc,IAAI;gBAC3C,cAAc,SAAS,YAAY,IAAI;gBACvC,WAAW,SAAS,SAAS,IAAI;gBACjC,SAAS,SAAS,OAAO,IAAI,EAAE;YACjC,CAAC;YACD,GAAI,SAAS,IAAI,KAAK,cAAc;gBAClC,aAAa,SAAS,WAAW,IAAI;gBACrC,eAAe,SAAS,aAAa,IAAI;gBACzC,cAAc,SAAS,YAAY,IAAI;YACzC,CAAC;QACH;QAEA,MAAM,IAAI,CAAC;QACX,UAAU;QAEV,gCAAgC;QAChC,QAAQ;QACR,aAAa,OAAO,CAAC,kBAAkB,KAAK,SAAS,CAAC;QAEtD,aAAa;QACb,OAAO;IACT;IAEA,MAAM,QAAyB;QAC7B;QACA;QACA;QACA;QACA,iBAAiB,CAAC,CAAC;QACnB;IACF;IAEA,qBAAO,4TAAC,YAAY,QAAQ;QAAC,OAAO;kBAAQ;;;;;;AAC9C;GAjHgB;KAAA;AAmHT,SAAS;;IACd,MAAM,UAAU,IAAA,0SAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB","debugId":null}}]
}